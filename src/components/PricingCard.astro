---
interface Props {
  name: string;
  price: string;
  period?: string;
  description: string;
  features: Array<{ title: string; subtitle?: string }>;
  badge?: string;
  badgeType?: 'free' | 'primary' | 'default';
  buttonText: string;
  buttonLink: string;
  featured?: boolean;
  guarantee?: string;
}

const {
  name,
  price,
  period = '/month',
  description,
  features,
  badge,
  badgeType = 'default',
  buttonText,
  buttonLink,
  featured = false,
  guarantee = '30-day money-back guarantee',
} = Astro.props;
---

<div class={`pricing-card-wrapper ${featured ? 'featured' : ''}`}>
  <div class="pricing-card-outer">
    <div class="pricing-card-gradient-bg"></div>

    <div class="pricing-card-inner">
      <!-- Decorative blur effects -->
      <div class="blur-effect top-left"></div>
      <div class="blur-effect bottom-right"></div>

      <!-- Featured badge -->
      {featured && badge && (
        <div class="corner-badge">
          <div class="badge-bg"></div>
          <div class="badge-overlay"></div>
          <div class="badge-stripe"></div>
          <span class="badge-text">{badge}</span>
        </div>
      )}

      <!-- Regular badge for non-featured -->
      {!featured && badge && (
        <div class={`pricing-badge ${badgeType}`}>{badge}</div>
      )}

      <!-- Header -->
      <div class="pricing-header">
        <h3 class="tier-name">{name}</h3>
        <div class="tier-price">
          <span class="amount">{price}</span>
          {period && <span class="period">{period}</span>}
        </div>
        <p class="tier-description">{description}</p>
      </div>

      <!-- Features -->
      <div class="features-list">
        {features.map((feature) => (
          <div class="feature-item">
            <div class="check-icon">
              <svg
                stroke="currentColor"
                viewBox="0 0 24 24"
                fill="none"
              >
                <path
                  d="M5 13l4 4L19 7"
                  stroke-width="2"
                  stroke-linejoin="round"
                  stroke-linecap="round"
                ></path>
              </svg>
            </div>
            <div class="feature-text">
              <p class="feature-title">{typeof feature === 'string' ? feature : feature.title}</p>
              {typeof feature !== 'string' && feature.subtitle && (
                <p class="feature-subtitle">{feature.subtitle}</p>
              )}
            </div>
          </div>
        ))}
      </div>

      <!-- CTA Button -->
      <div class="cta-wrapper">
        <a href={buttonLink} class="cta-button">
          <div class="cta-inner">
            <span class="cta-text">
              {buttonText}
              <svg
                stroke="currentColor"
                viewBox="0 0 24 24"
                fill="none"
                class="arrow-icon"
              >
                <path
                  d="M17 8l4 4m0 0l-4 4m4-4H3"
                  stroke-width="2"
                  stroke-linejoin="round"
                  stroke-linecap="round"
                ></path>
              </svg>
            </span>
          </div>
        </a>
      </div>

      <!-- Guarantee -->
      {guarantee && (
        <div class="guarantee">
          <svg
            stroke="currentColor"
            viewBox="0 0 24 24"
            fill="none"
          >
            <path
              d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"
              stroke-width="2"
              stroke-linejoin="round"
              stroke-linecap="round"
            ></path>
          </svg>
          <span>{guarantee}</span>
        </div>
      )}
    </div>
  </div>
</div>

<style>
  .pricing-card-wrapper {
    position: relative;
    width: 100%;
    max-width: 360px;
  }

  .pricing-card-wrapper:hover {
    transform: translateY(-8px);
  }

  .pricing-card-wrapper.featured:hover {
    transform: translateY(-12px);
  }

  .pricing-card-outer {
    position: relative;
    overflow: hidden;
    border-radius: var(--radius-2xl);
    background: linear-gradient(to bottom, var(--color-gray-950), var(--color-gray-900));
    padding: 1px;
    box-shadow: var(--elevation-3);
    transition: all var(--transition-base);
  }

  .pricing-card-wrapper:hover .pricing-card-outer {
    box-shadow: var(--elevation-5), var(--glow-soft);
  }

  .pricing-card-wrapper.featured .pricing-card-outer {
    box-shadow: var(--elevation-4), var(--glow-primary);
  }

  .pricing-card-wrapper.featured:hover .pricing-card-outer {
    box-shadow: var(--elevation-5), 0 0 40px rgba(147, 51, 234, 0.3);
  }

  .pricing-card-gradient-bg {
    position: absolute;
    inset: 0;
    background: linear-gradient(to bottom, var(--color-primary-500), var(--color-accent-500));
    opacity: 0.2;
  }

  .pricing-card-wrapper.featured .pricing-card-gradient-bg {
    opacity: 0.3;
  }

  .pricing-card-inner {
    position: relative;
    border-radius: var(--radius-2xl);
    background: linear-gradient(to bottom, var(--color-gray-950), var(--color-gray-900));
    padding: var(--space-8);
    min-height: 480px;
    display: flex;
    flex-direction: column;
  }

  /* Blur effects */
  .blur-effect {
    position: absolute;
    height: 128px;
    width: 128px;
    border-radius: 50%;
    filter: blur(40px);
    transition: all 500ms ease;
    pointer-events: none;
  }

  .blur-effect.top-left {
    left: -64px;
    top: -64px;
    background: radial-gradient(circle, rgba(147, 51, 234, 0.2), transparent);
  }

  .blur-effect.bottom-right {
    right: -64px;
    bottom: -64px;
    background: radial-gradient(circle, rgba(132, 204, 22, 0.2), transparent);
  }

  .pricing-card-wrapper:hover .blur-effect {
    transform: scale(1.5);
    opacity: 0.7;
  }

  /* Corner badge for featured */
  .corner-badge {
    position: absolute;
    right: -1px;
    top: -1px;
    overflow: hidden;
    border-top-right-radius: var(--radius-2xl);
    z-index: 10;
  }

  .badge-bg {
    position: absolute;
    height: 80px;
    width: 80px;
    background: linear-gradient(135deg, var(--color-primary-500), var(--color-accent-500));
  }

  .badge-overlay {
    position: absolute;
    height: 80px;
    width: 80px;
    background: var(--color-gray-950);
    opacity: 0.9;
  }

  .badge-stripe {
    position: absolute;
    right: 0;
    top: 22px;
    height: 2px;
    width: 56px;
    transform: rotate(45deg);
    background: linear-gradient(90deg, var(--color-primary-500), var(--color-accent-500));
  }

  .badge-text {
    position: absolute;
    right: 4px;
    top: 4px;
    font-size: 10px;
    font-weight: var(--weight-semibold);
    color: white;
    letter-spacing: 0.05em;
  }

  /* Regular badge */
  .pricing-badge {
    display: inline-block;
    padding: var(--space-2) var(--space-4);
    border-radius: var(--radius-full);
    font-size: var(--text-xs);
    font-weight: var(--weight-semibold);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    background-color: var(--color-gray-200);
    color: var(--color-gray-700);
    width: fit-content;
    margin-bottom: var(--space-4);
  }

  .pricing-badge.free {
    background: linear-gradient(135deg, var(--color-accent-100), var(--color-accent-200));
    color: var(--color-accent-900);
  }

  .pricing-badge.primary {
    background: linear-gradient(135deg, var(--color-primary-600), var(--color-primary-700));
    color: white;
  }

  /* Header */
  .pricing-header {
    position: relative;
    margin-bottom: var(--space-6);
  }

  .tier-name {
    font-size: var(--text-sm);
    font-weight: var(--weight-medium);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--color-primary-400);
    margin-bottom: var(--space-2);
  }

  .tier-price {
    display: flex;
    align-items: baseline;
    gap: var(--space-2);
    margin-bottom: var(--space-2);
  }

  .amount {
    font-size: var(--text-4xl);
    font-weight: var(--weight-bold);
    color: white;
  }

  .period {
    font-size: var(--text-sm);
    color: var(--color-gray-400);
  }

  .tier-description {
    font-size: var(--text-sm);
    color: var(--color-gray-400);
    line-height: 1.5;
  }

  /* Features list */
  .features-list {
    position: relative;
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
    flex: 1;
  }

  .feature-item {
    display: flex;
    align-items: flex-start;
    gap: var(--space-3);
  }

  .check-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 24px;
    width: 24px;
    flex-shrink: 0;
    border-radius: 50%;
    background: rgba(147, 51, 234, 0.1);
  }

  .check-icon svg {
    height: 16px;
    width: 16px;
    color: var(--color-primary-400);
  }

  .feature-text {
    display: flex;
    flex-direction: column;
  }

  .feature-title {
    font-size: var(--text-sm);
    font-weight: var(--weight-medium);
    color: white;
  }

  .feature-subtitle {
    font-size: var(--text-xs);
    color: var(--color-gray-400);
    margin-top: 2px;
  }

  /* CTA Button */
  .cta-wrapper {
    position: relative;
    margin-top: var(--space-8);
  }

  .cta-button {
    display: block;
    width: 100%;
    overflow: hidden;
    border-radius: var(--radius-xl);
    background: linear-gradient(135deg, var(--color-primary-500), var(--color-accent-500));
    padding: 1px;
    font-weight: var(--weight-semibold);
    color: white;
    text-decoration: none;
    box-shadow: inset 0 1000px 0 0 transparent;
    transition: all var(--transition-base);
  }

  .cta-button:hover {
    box-shadow: inset 0 1000px 0 0 rgba(255, 255, 255, 0.02);
  }

  .cta-inner {
    position: relative;
    border-radius: var(--radius-xl);
    background: rgba(0, 0, 0, 0.5);
    padding: var(--space-3) var(--space-4);
    transition: all var(--transition-base);
  }

  .cta-button:hover .cta-inner {
    background: transparent;
  }

  .cta-text {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
  }

  .arrow-icon {
    height: 16px;
    width: 16px;
    transition: transform var(--transition-fast);
  }

  .cta-button:hover .arrow-icon {
    transform: translateX(4px);
  }

  /* Guarantee */
  .guarantee {
    margin-top: var(--space-4);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
  }

  .guarantee svg {
    height: 16px;
    width: 16px;
    color: var(--color-gray-400);
  }

  .guarantee span {
    font-size: var(--text-xs);
    font-weight: var(--weight-medium);
    color: var(--color-gray-400);
  }

  /* Responsive */
  @media (max-width: 768px) {
    .pricing-card-wrapper {
      max-width: 100%;
    }

    .pricing-card-inner {
      padding: var(--space-6);
      min-height: 420px;
    }
  }

  /* Light mode adjustments */
  [data-theme="light"] .pricing-card-outer {
    background: linear-gradient(to bottom, var(--color-gray-100), var(--color-gray-50));
  }

  [data-theme="light"] .pricing-card-inner {
    background: linear-gradient(to bottom, var(--color-gray-100), var(--color-gray-50));
  }

  [data-theme="light"] .badge-overlay {
    background: var(--color-gray-100);
  }

  [data-theme="light"] .amount {
    color: var(--color-gray-900);
  }

  [data-theme="light"] .feature-title {
    color: var(--color-gray-900);
  }

  [data-theme="light"] .cta-inner {
    background: rgba(255, 255, 255, 0.5);
  }
</style>
